theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
plot(mytsnecluster)
####################
library(ggforce)
limit = 20
mytsne <- ggplot(tsne_plot) +
geom_point(aes(x=x, y=y, color=Cancer_Type)) +
geom_mark_ellipse(data = tsne_plot[dbclusters!=0 & as.numeric(dbclusters)<=limit,], aes(x=x, y=y, group = dbclusters[dbclusters!=0 & as.numeric(dbclusters)<=limit], label = dbclusters[dbclusters!=0 & as.numeric(dbclusters)<=limit]),
label.buffer = unit(0.1, 'mm'), con.cap = 0.01, con.type = "straight", label.fontsize = 30, label.fontface = 'plain') +
#geom_label(aes(x=x, y=y, label=Cancer_Type))+
labs(col="Cancer")+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),
legend.text = element_text(size=20),
legend.title = element_text(size=20),
axis.text = element_text(size=15),
axis.title = element_text(size=20))+
guides(color = guide_legend(override.aes = list(size = 4)))
png(paste('./figures/interaction_tsne_numbered', '.png', sep = ""), width = 1400, height = 1400, res = 120)
par(mar=c(10,10,10,10))
plot(mytsne)
dev.off()
################
#find largest clusters
summary_clusters <- summary(dbclusters[dbclusters!=0]) %>% sort(decreasing = T)
summary_clusters[1:8]
summary_clusters
#################
# generate median position
mean_frame <- aggregate(test_data$LRP, by = list(masked_protein = test_data$masked_protein, predicting_protein = test_data$predicting_protein), median)
mean_quantile <- quantile(mean_frame$x, 0.9)
mean_frame$x[mean_frame$x<mean_quantile] <- 0
mean_frame_wide <- mean_frame %>% pivot_wider(names_from = masked_protein, values_from = x)
mean_matrix <- mean_frame_wide[,-1] %>% as.matrix()
rownames(mean_matrix) <- mean_frame_wide$predicting_protein
mean_graph <- graph_from_adjacency_matrix(mean_matrix, mode = "directed", weighted = T)
E(mean_graph)[E(mean_graph)$weight>0]$color <- "red"
E(mean_graph)[E(mean_graph)$weight<0]$color <- "blue"
E(mean_graph)$weight <- 0.01#/(1+E(mean_graph)$weight) #* E(mean_graph)$weight) # 0.01/(1+E(mean_graph)$weight)
set.seed(1)
mean_positions =  layout_nicely(mean_graph) # layout_on_sphere(mean_graph) # layout_on_sphere(mean_graph) #
plot(mean_graph,  layout = mean_positions, vertex.label=NA, vertex.size = 2, vertex.color = "black", edge.width = 3, vertex.label.dist=1,
vertex.label.cex = 0.7, edge.arrow.width=0.4, edge.arrow.size=0.1, rescale = T)
################
seedfunction <- function(clusternumber){
seed=0
if (clusternumber==5) {seed = 0}
if (clusternumber==8) {seed = 0}
print(seed)
seed
}
cutofffunction <- function(clusternumber){
#for visibility
cutoff=0.9997
if (clusternumber==2) {cutoff = 0.999}
#if (clusternumber==6) {cutoff = 0.9998}
#if (clusternumber==8) {cutoff = 0.999}
cutoff
}
library(dplyr)
library(igraph)
dir.create('./figures/temp/')
nclusters <- dbclusters %>% unique %>% length()-1
for (current_cluster in seq(nclusters)){
current_cluster_position <- cluster_data %>% filter(dbclusters==current_cluster) #CAVE: cluster_data is not yet spaced, only applies to t-SNE
current_cluster_data <- test_data %>% filter(ID %in% current_cluster_position$ID)
####
#symmetrize current cluster data for average network
current_cluster_data_dir <- current_cluster_data %>% dplyr::select(predicting_protein, masked_protein, LRP, ID)
current_cluster_data_trans <- current_cluster_data_dir
colnames(current_cluster_data_trans)[1] <- "masked_protein"
colnames(current_cluster_data_trans)[2] <- "predicting_protein"
colnames(current_cluster_data_trans)[3] <- "tLRP"
current_cluster_data_sym <- left_join(current_cluster_data_dir, current_cluster_data_trans) %>%
mutate("LRP_sym" = 0.5*(abs(LRP)+abs(tLRP)))#%>%
#  dplyr::filter(predicting_protein>masked_protein)
####
average_frame <- current_cluster_data_sym %>% group_by(predicting_protein, masked_protein) %>%
dplyr::summarize("meanLRP"= median(LRP_sym)) %>%
pivot_wider(names_from = masked_protein, values_from = meanLRP)
average_matrix <- average_frame[,-1] %>% as.matrix()
rownames(average_matrix) <- average_frame$predicting_protein
average_matrix_ordered <- average_matrix[str_order(rownames(average_matrix)), str_order(colnames(average_matrix))]
cutoff_param <- cutofffunction(current_cluster)
#cutoff_ID <- average_matrix_ordered %>% abs() %>% quantile(cutoff_param)
####
forthresh <- current_cluster_data_sym %>% group_by(predicting_protein, masked_protein) %>%
dplyr::summarize("meanLRP"= median(LRP_sym)) %>%
dplyr::arrange(desc(meanLRP))
for (thresh in forthresh$meanLRP) {
high_edges <- forthresh %>% filter(meanLRP>=thresh)
if (c(high_edges$predicting_protein, high_edges$masked_protein) %>% unique() %>% length() >=7) {
cutoff_ID <- thresh
break
}
}
####
average_matrix_ordered_select <- ifelse(abs(average_matrix_ordered) >= cutoff_ID, average_matrix_ordered,0)
average_network <- graph_from_adjacency_matrix(average_matrix_ordered_select, weighted=T, mode="directed")
positions <- cbind(V(average_network),mean_positions)
#reduced_positions <- positions[degree(average_network) >0,]
vertices2delete <- positions[igraph::degree(average_network) ==0,1] %>% as.vector()
average_network2 <- delete_vertices(average_network, vertices2delete)
E(average_network2)[E(average_network2)$weight>0]$color <- "black"
thresh <- igraph::degree(average_network2) %>% sort(decreasing = T) %>% .[10] %>% max(c(.,1), na.rm=T)
selected_names <- V(average_network2)$name[rev(order(igraph::degree(average_network2)))] %>% .[1:min(20, length(.))]
set.seed(seedfunction(current_cluster))
l = layout_in_circle(average_network2, sample(seq(length(V(average_network2)))))
png(paste('./figures/temp/average_ID_', current_cluster, '.png', sep=""), width=2000, height = 1700, res=200)
#par(mar=c(4,11,5,8))
par(mar=c(0,11,0,8))
#qgraph(as_edgelist(average_network2),edge.labels=T)
#plot(average_network,  layout = mean_positions, vertex.label= ifelse(degree(average_network)>=thresh,V(average_network)$name, NA), vertex.size = 0.01, vertex.color = NA,
#     edge.width = 4.0, vertex.label.dist=1.0,
#     vertex.label.cex = 4.5, edge.arrow.width=0.1, edge.arrow.size=0.1, rescale = T)
plot(average_network2, layout = l, edge.width = 3.0, vertex.color = "white", vertex.size = 0, vertex.label.cex = 2.0, edge.arrow.size=0,
vertex.label= ifelse(V(average_network2)$name %in% selected_names,V(average_network2)$name, NA), vertex.label.family = "Helvetica")
text(x=-1.7, y=1.2, label=as.character(current_cluster), cex=5) #x=-1.3, y=1.2, cex=5
dev.off()
for (current_ID in current_cluster_position$ID) {
print(current_ID)
current_network_position <- current_cluster_position %>% filter(ID==current_ID)
current_network <- current_cluster_data %>% filter(ID==current_ID)
IDframe <- current_network %>%
dplyr::select(predicting_protein, masked_protein, LRP ) %>%
pivot_wider(names_from = "masked_protein", values_from = "LRP")
IDmatrix <- IDframe[,-1] %>% as.matrix()
rownames(IDmatrix) <- IDframe$predicting_protein
IDmatrix_ordered <- IDmatrix[str_order(rownames(IDmatrix)), str_order(colnames(IDmatrix))]
cutoff_ID <- IDmatrix_ordered %>% abs() %>% quantile(0.999)
IDmatrix_ordered_select <- ifelse(abs(IDmatrix_ordered) >= cutoff_ID, IDmatrix_ordered,0)
IDgraph <- graph_from_adjacency_matrix(IDmatrix_ordered_select, mode = "directed", weighted=T)
E(IDgraph)[E(IDgraph)$weight>0]$color <- "red"
E(IDgraph)[E(IDgraph)$weight<0]$color <- "blue"
current_positions <- data.frame(x = mean_positions[,1] + 10+current_network_position$x, y = mean_positions[,2] + 10+current_network_position$y) %>% as.matrix()
png(paste('./figures/temp/', current_ID, '.png', sep=""), width=500, height = 500)
par(bg=NA)
par(oma = c(0,0,0,0), mar=c(0,0,0,0))
plot(IDgraph,  layout = mean_positions, vertex.label=NA, vertex.size = 0.01, vertex.color = NA, edge.width = 4.0, vertex.label.dist=1,
vertex.label.cex = 0.7, edge.arrow.width=0.1, edge.arrow.size=0.1, rescale = T)
dev.off()
}
#########################
library(png)
scale_it <- function(x,low,high) {
x_scaled <- x/(max(x)-min(x))*(high-low)
x_end <- x_scaled-min(x_scaled)+low
}
image_size = 0.14 # 0.15
current_position_normalized <- current_cluster_position %>% mutate("x" = scale_it(x,0.5*image_size,1-0.5*image_size), "y" = scale_it(y,0.5*image_size,1-0.5*image_size))
png(paste('./figures/temp/','cluster_',current_cluster ,'.png', sep=""), width = 2000, height = 2000, res=200)
par(oma = c(0,0,0,0), mar=c(0,0,0,0)) #delete this?! was added 3.5.2021
plot.new()
for (current_ID in current_cluster_position$ID) {
print(current_ID)
current_image <- readPNG(paste('./figures/temp/', current_ID, '.png', sep=""))
#current_image[1:500, c(1:2,499:500),] <- 0
#current_image[c(1:2,499:500), 1:500, ] <- 0
current_network_position <- current_position_normalized %>% filter(ID==current_ID)
x = current_network_position$x
y = current_network_position$y
rasterImage(current_image, x-0.5*image_size,y-0.5*image_size,x+0.5*image_size,y+0.5*image_size)
}
text(x=0.0, y=0.95, label=as.character(current_cluster), cex=5)
dev.off()
}
###############################
#########################################################
#test interactions between c-MET caspase8 parpcleaved Snail ercc1
library(ggExtra)
selprots <- c("CMET", "CASPASE8", "PARPCLEAVED", "SNAIL", "ERCC1")
quintum <-test_data %>% ungroup()%>%
dplyr::filter(predicting_protein %in% selprots, masked_protein %in% selprots, predicting_protein!=masked_protein) %>%
dplyr::select(ID, Cancer_Type, predicting_protein, masked_protein, LRP)
t_quintum <- quintum
colnames(t_quintum) <- c("ID", "Cancer_Type", "masked_protein", "predicting_protein", "tLRP")
symmetric_quintum <- left_join(quintum, t_quintum) %>% mutate("new_LRP" = 0.5*(abs(LRP)+abs(tLRP))) %>% filter(predicting_protein < masked_protein)
library('scales')
marginplots <- function(selCancer_Type) {
quintum_raw <-  symmetric_quintum %>%
dplyr::select(ID, Cancer_Type, predicting_protein, masked_protein, new_LRP) %>%
unite("interaction",predicting_protein:masked_protein) %>% mutate(logLRP = log(1+new_LRP)) %>% filter(Cancer_Type==selCancer_Type)
p <- ggplot(quintum_raw, aes(x= as.numeric(as.factor(interaction)), y =logLRP)) +
geom_point(alpha = 0.0) +
geom_line(aes(color = ID, group = ID), show.legend = F) +
ggtitle(selCancer_Type) +
ylim(0,5.0)+
xlab('Interactions')+
theme_bw()+
scale_x_continuous(breaks = pretty_breaks())
theme(plot.title = element_text(size=15, margin = margin(10,0, 0,0)),
axis.title.x = element_blank(),
plot.margin = margin(0,0,0,0))
p2 <- ggMarginal(p, type="histogram", margins = "y")
p2
}
#################################
Cancer_Types <- symmetric_quintum$Cancer_Type %>% unique()%>% unlist()
marplots <- lapply(Cancer_Types, marginplots)
library(ggpubr)
png("./figures/quintum.png",width = 1000, height = 1000)
ggarrange(plotlist=marplots)
dev.off()
library(dplyr)
library(ggplot2)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
results <- read.csv('cv.csv') %>%
group_by(depth, neurons, epoch,  lr) %>%
dplyr::summarize(meanloss = mean(testloss), medianloss = median(testloss, na.rm=T),n = n())
forplot <-  read.csv('cv.csv') %>%
mutate(depth = paste0('depth = ', depth), lr_loop = paste0(lr, loop))
png('../../plots_statistics/figures/crossval_median.png', height=800, width=800, res=100)
ggplot(results, aes(x = epoch, y = medianloss, group = lr, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
png('../../plots_statistics/figures/crossval.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log2') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
end <- results %>% filter(lr == 0.03, depth== 1, neurons==10)
library(dplyr)
library(ggplot2)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
results <- read.csv('cv.csv') %>%
group_by(depth, neurons, epoch,  lr) %>%
dplyr::summarize(meanloss = mean(testloss), medianloss = median(testloss, na.rm=T),n = n())
forplot <-  read.csv('cv.csv') %>%
mutate(depth = paste0('depth = ', depth), lr_loop = paste0(lr, loop))
png('../../plots_statistics/figures/crossval_median.png', height=800, width=800, res=100)
ggplot(results, aes(x = epoch, y = medianloss, group = lr, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
png('../../plots_statistics/figures/crossval.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log2') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
end <- results %>% filter(lr == 0.03, depth== 1, neurons==10)
View(results)
library(dplyr)
library(ggplot2)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
results <- read.csv('cv.csv') %>%
group_by(depth, neurons, epoch,  lr) %>%
dplyr::summarize(meanloss = mean(testloss), medianloss = median(testloss, na.rm=T),n = n())
forplot <-  read.csv('cv.csv') %>%
mutate(depth = paste0('depth = ', depth), lr_loop = paste0(lr, loop))
png('../../plots_statistics/figures/crossval_mean.png', height=800, width=800, res=100)
ggplot(results, aes(x = epoch, y = meanloss, group = lr, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
png('../../plots_statistics/figures/crossval.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log2') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
forplot <-  read.csv('cv.csv') %>%
mutate(depth = paste0('depth = ', depth+1), lr_loop = paste0(lr, loop))
png('../../plots_statistics/figures/crossval_mean.png', height=800, width=800, res=100)
ggplot(results, aes(x = epoch, y = meanloss, group = lr, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
png('../../plots_statistics/figures/crossval.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log2') +
#scale_x_continuous(trans='log10') +
theme_bw()
dev.off()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
theme_bw()
end <- results %>% filter(lr == 0.03, depth== 2, neurons==10)
end
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
+ guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch')
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch') +
theme_bw()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch') +
ylab('test loss') +
theme_bw()
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch') +
ylab('test loss') +
theme_bw()
png('../../plots_statistics/figures/crossval.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch') +
ylab('test loss') +
theme_bw()
dev.off()
png('../../plots_statistics/figures/Supp_6_Revision.png', height=1000, width=1000, res=100)
ggplot(forplot, aes(x = epoch, y = testloss, group = lr_loop, color =as.factor(lr))) +
geom_line() +
facet_grid(as.factor(depth)~neurons) +
scale_y_continuous(trans='log10') +
#scale_x_continuous(trans='log10') +
guides(fill=guide_legend(title="learning rate")) +
xlab('Epoch') +
ylab('test loss') +
theme_bw()
dev.off()
library(ggplot2)
library(stringr)
library(magrittr)
library(tiyr)
library(dplyr)
library(DescTools)
library(gplots)
library(pbmcapply)
library(circlize)
library(data.table)
library(Hmisc)
library(stringi)
library(igraph)
library(e1071)
library(VGAM)
library(abind)
library(graphlayouts)
library(ComplexHeatmap)
library(plyr)
library(stats)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
textsize = 30
axistext=30
RAWPATH = '../results/artificial/heterogeneous/raw_data/'
filenames <- list.files(RAWPATH)
LRP_data_raw <-rbindlist(lapply(filenames, function(filename) fread(paste0(RAWPATH, filename)))) %>%
dplyr::select(LRP, predicting_protein, masked_protein, sample_name)
LRP_data_raw$LRP = abs(LRP_data_raw$LRP)
LRP_data_d <- LRP_data_raw
colnames(LRP_data_d) <- c("dLRP", "predicting_protein", "masked_protein", "sample_name")
LRP_data_t <- LRP_data_raw %>% dplyr::select(predicting_protein, masked_protein, sample_name, LRP)
colnames(LRP_data_t) <- c("masked_protein", "predicting_protein", "sample_name", "tLRP")
LRP_data <- left_join(LRP_data_d, LRP_data_t, by = c("predicting_protein", "masked_protein", "sample_name")) %>% mutate("LRP" = 0.5*(dLRP+tLRP))
#specifiy number of samples per row
numberpresample = 15
sample_names <- LRP_data$sample_name %>%unique()
set.seed(1)
group1 <- sample(sample_names[sample_names < 1000], numberpresample)
set.seed(2)
group2 <- sample(sample_names[sample_names >= 1000 & sample_names < 2000], numberpresample)
set.seed(3)
group3 <- sample(sample_names[sample_names >= 2000 & sample_names < 3000], numberpresample)
set.seed(4)
group4 <- sample(sample_names[sample_names >= 3000 & sample_names < 4000], numberpresample)
#add group variable and select sample_names for display
LRP_data_sel  <- LRP_data %>%
dplyr::group_by(predicting_protein, masked_protein) %>%
mutate("sample_group" = sample_name %/%1000+1) %>%
filter(sample_name %in% c(group1,group2,group3,group4)) %>%
group_by(sample_group) %>%
dplyr::mutate('rank' = as.factor(as.numeric(as.factor(sample_name))))
log_LRP_sel <- LRP_data_sel %>% dplyr::select(predicting_protein, masked_protein, LRP, sample_name, sample_group, rank) %>%
group_by(sample_name) %>%
mutate("LRP" = LRP, "group_sample_name" = sample_name%%1000)
showsample_name <- log_LRP_sel%>% filter(rank ==1) %>%
mutate("LRP" = ifelse(predicting_protein <= sample_group*8 & predicting_protein >= sample_group*8-7 &
masked_protein <= sample_group*8 & masked_protein >= sample_group*8-7,max(log_LRP_sel$LRP)*0.9,0))
showsample_name$rank = as.factor(0)
log_LRP_sel_combined <- rbind(showsample_name, log_LRP_sel) %>% dplyr::arrange(predicting_protein, masked_protein)
single_sample_plot <- ggplot(log_LRP_sel_combined, aes(predicting_protein, y = masked_protein, fill = LRP)) +
ggtitle('I') +
geom_tile() +
scale_y_continuous(trans = "reverse") +
facet_grid(sample_group ~ rank) +
theme_bw() +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_text(size=axistext),
axis.title = element_text(size=textsize, face = 'plain'),
#title = element_text(size = 30, hjust = -1),
plot.title = element_text(size = 35, hjust = -0.02, face='plain'),
legend.title = element_text(size=textsize),
legend.text = element_text(size = axistext),
axis.text = element_text(size=axistext)
) +
xlab('Source protein') +
ylab('Target protein') +
#scale_fill_distiller(palette = "RdGy", direction = -1)+
scale_fill_distiller(palette = "Spectral")+
scale_x_continuous(breaks=c(1,20))
png('./figures/heatmaps.png', width = 3000, height = 1000)
single_sample_plot
dev.off()
#########################################################################################################
#boxplots
grouped_LRP_data <- LRP_data %>% mutate("sample_group" = as.numeric(sample_name) %/%1000+1, "pp_group" = as.numeric(predicting_protein) %/%8+1, "mp_group" = as.numeric(masked_protein) %/%8+1)
aggregated_LRP_data <- grouped_LRP_data %>% group_by(sample_name, pp_group, mp_group, sample_group) %>%
dplyr::summarize(meanLRP = (mean(LRP))) %>% mutate("grsample_name_" = 10*pp_group + mp_group)
aggregated_LRP_data$pp_group <- as.factor(aggregated_LRP_data$pp_group)
aggregated_LRP_data$mp_group <- as.factor(aggregated_LRP_data$mp_group)
levels(aggregated_LRP_data$pp_group) <- c("Pr 1-8", "Pr 9-16","Pr 17-24","Pr 25-32")
levels(aggregated_LRP_data$mp_group) <-c("Proteins 1-8", "Proteins 9-16","Proteins 17-24","Proteins 25-32")
boxplot <- ggplot(aggregated_LRP_data, aes(x =sample_group, y=(meanLRP), group = sample_group)) +
geom_boxplot(outlier.shape=NA) +
facet_grid(pp_group ~ mp_group)+
ggtitle('J') +
xlab("Interaction group")+
ylab("LRP")+
coord_trans(y = 'log2')+
scale_y_continuous(breaks = c(0.0, 0.1, 1.0, 10)) +
theme_bw() +
theme(
axis.title = element_text(size=textsize),
axis.text = element_text(size=axistext),
#title = element_text(size = 30),
plot.title = element_text(size = 35, hjust = -0.04, face='plain'),
strip.background = element_blank(),
strip.text.x = element_text(size= 0.9*axistext),
strip.text.y = element_text(size= 0.9* axistext)
)
png(paste('./figures/art_box_plot.png'), width = 1000, height = 800)
boxplot
dev.off()
boxplot
boxplot <- ggplot(aggregated_LRP_data, aes(x =sample_group, y=(meanLRP), group = sample_group)) +
geom_boxplot() +
facet_grid(pp_group ~ mp_group)+
ggtitle('J') +
xlab("Interaction group")+
ylab("LRP")+
coord_trans(y = 'log2')+
scale_y_continuous(breaks = c(0.0, 0.1, 1.0, 10)) +
theme_bw() +
theme(
axis.title = element_text(size=textsize),
axis.text = element_text(size=axistext),
#title = element_text(size = 30),
plot.title = element_text(size = 35, hjust = -0.04, face='plain'),
strip.background = element_blank(),
strip.text.x = element_text(size= 0.9*axistext),
strip.text.y = element_text(size= 0.9* axistext)
)
boxplot
